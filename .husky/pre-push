#!/usr/bin/env sh

# 1. ë¸Œëœì¹˜ íŒ¨í„´ ê²€ì‚¬
BRANCH_NAME=$(git symbolic-ref --short HEAD)
echo "$BRANCH_NAME" | grep -Eq '^(main|release|dev|hotfix|docs|feat/[a-z0-9._/-]+|fix/[a-z0-9._/-]+|refactor/[a-z0-9._/-]+|test/[a-z0-9._/-]+|chore/[a-z0-9._/-]+)$' \
  || { echo "ğŸš« ë¸Œëœì¹˜ ì´ë¦„ ì˜ëª» ì‘ì„±í•¨!!"; exit 1; }

# 2. ì‹œí¬ë¦¿ í‚¤ ê²€ì¦
if ! command -v gitleaks >/dev/null 2>&1; then
  echo "âš ï¸ gitleaksê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šì•„ ì‹œí¬ë¦¿ ìŠ¤ìº”ì„ ê±´ë„ˆëœë‹ˆë‹¤."
  echo "   ì„¤ì¹˜ ë°©ë²•: macOS â†’ brew install gitleaks / Windows â†’ choco install gitleaks"
  exit 1
else
  echo "pre-push / ì‹œí¬ë¦¿ í‚¤ ê²€ì¦..."
  gitleaks detect --no-git --source . --redact --no-banner
fi

